"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_pages-dir-node_components_LDRViewer_tsx";
exports.ids = ["_pages-dir-node_components_LDRViewer_tsx"];
exports.modules = {

/***/ "(pages-dir-node)/./components/LDRViewer.tsx":
/*!**********************************!*\
  !*** ./components/LDRViewer.tsx ***!
  \**********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! three */ \"three\");\n/* harmony import */ var three_examples_jsm_controls_OrbitControls_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! three/examples/jsm/controls/OrbitControls.js */ \"three/examples/jsm/controls/OrbitControls.js\");\n/* harmony import */ var three_examples_jsm_loaders_LDrawLoader_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! three/examples/jsm/loaders/LDrawLoader.js */ \"three/examples/jsm/loaders/LDrawLoader.js\");\n/* harmony import */ var three_examples_jsm_materials_LDrawConditionalLineMaterial_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! three/examples/jsm/materials/LDrawConditionalLineMaterial.js */ \"three/examples/jsm/materials/LDrawConditionalLineMaterial.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([three__WEBPACK_IMPORTED_MODULE_2__, three_examples_jsm_controls_OrbitControls_js__WEBPACK_IMPORTED_MODULE_3__, three_examples_jsm_loaders_LDrawLoader_js__WEBPACK_IMPORTED_MODULE_4__, three_examples_jsm_materials_LDrawConditionalLineMaterial_js__WEBPACK_IMPORTED_MODULE_5__]);\n([three__WEBPACK_IMPORTED_MODULE_2__, three_examples_jsm_controls_OrbitControls_js__WEBPACK_IMPORTED_MODULE_3__, three_examples_jsm_loaders_LDrawLoader_js__WEBPACK_IMPORTED_MODULE_4__, three_examples_jsm_materials_LDrawConditionalLineMaterial_js__WEBPACK_IMPORTED_MODULE_5__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\nconst LDRViewerComponent = ({ modelPath, ldrawContent })=>{\n    const containerRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const sceneRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const rendererRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const cameraRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const controlsRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const modelGroupRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const loadingManagerRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const isLoadingRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    const currentModelPathRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)('');\n    const isInitializedRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    const errorCountRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n    // Create loading manager only once\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"LDRViewerComponent.useEffect\": ()=>{\n            if (loadingManagerRef.current) return;\n            const manager = new three__WEBPACK_IMPORTED_MODULE_2__.LoadingManager();\n            // Implement path resolution strategy similar to Three.js packLDrawModel\n            manager.setURLModifier({\n                \"LDRViewerComponent.useEffect\": (url)=>{\n                    // console.log('Original URL:', url);\n                    // Normalize path separators\n                    let normalized = url.replace(/\\\\/g, '/');\n                    // Handle s\\ prefix for subparts (convert s\\file.dat to s/file.dat)\n                    if (normalized.includes('s/') || normalized.match(/s[\\\\\\/]/)) {\n                        const parts = normalized.split(/[\\\\\\/]/);\n                        const lastTwo = parts.slice(-2);\n                        if (lastTwo[0] === 's') {\n                            // This is a subpart reference\n                            normalized = `/ldraw/parts/s/${lastTwo[1]}`;\n                            // console.log('Subpart detected, normalized to:', normalized);\n                            return normalized;\n                        }\n                    }\n                    // Extract the filename and check for subdirectory (like s/)\n                    const urlParts = normalized.split('/');\n                    const filename = urlParts[urlParts.length - 1].toLowerCase();\n                    const hasSubdir = urlParts.length >= 2 && urlParts[urlParts.length - 2] === 's';\n                    // Define possible path prefixes to try\n                    const pathPrefixes = [\n                        '/output/',\n                        '/ldraw/',\n                        '/ldraw/p/',\n                        '/ldraw/parts/'\n                    ];\n                    // If the URL already has a valid prefix, clean it up\n                    for (const prefix of pathPrefixes){\n                        if (normalized.includes(prefix)) {\n                            // Clean up any duplicate path segments\n                            normalized = normalized.replace(/\\/ldraw\\/parts\\/parts\\//g, '/ldraw/parts/');\n                            normalized = normalized.replace(/\\/ldraw\\/p\\/p\\//g, '/ldraw/p/');\n                            normalized = normalized.replace(/\\/output\\/output\\//g, '/output/');\n                            // Remove any redundant path combinations but preserve s/ subdirectory\n                            if (!normalized.includes('/s/')) {\n                                normalized = normalized.replace(/\\/ldraw\\/parts\\/p\\//g, '/ldraw/p/');\n                                normalized = normalized.replace(/\\/output\\/p\\//g, '/ldraw/p/');\n                                normalized = normalized.replace(/\\/ldraw\\/p\\/parts\\//g, '/ldraw/parts/');\n                                normalized = normalized.replace(/\\/output\\/parts\\//g, '/ldraw/parts/');\n                            } else {\n                                // Handle subparts in s/ directory\n                                normalized = normalized.replace(/\\/ldraw\\/parts\\/parts\\/s\\//g, '/ldraw/parts/s/');\n                                normalized = normalized.replace(/\\/ldraw\\/p\\/parts\\/s\\//g, '/ldraw/parts/s/');\n                                normalized = normalized.replace(/\\/output\\/parts\\/s\\//g, '/ldraw/parts/s/');\n                            }\n                            // console.log('Normalized URL:', normalized);\n                            return normalized;\n                        }\n                    }\n                    // If no valid prefix found, try to construct the path\n                    // This handles cases where the URL is just a filename or relative path\n                    if (!normalized.startsWith('/ldraw/')) {\n                        // Handle subparts (files in s/ directory)\n                        if (hasSubdir) {\n                            normalized = `/ldraw/parts/s/${filename}`;\n                        } else if (filename.match(/^\\d/) || filename.startsWith('stud') || filename.startsWith('edge')) {\n                            normalized = `/ldraw/p/${filename}`;\n                        } else if (filename.endsWith('.dat')) {\n                            normalized = `/ldraw/parts/${filename}`;\n                        } else if (filename.endsWith('.ldr') || filename.endsWith('.mpd')) {\n                            normalized = `/output/${filename}`;\n                        }\n                    // console.log('Constructed URL:', normalized);\n                    }\n                    return normalized;\n                }\n            }[\"LDRViewerComponent.useEffect\"]);\n            loadingManagerRef.current = manager;\n            return ({\n                \"LDRViewerComponent.useEffect\": ()=>{\n                    manager.setURLModifier(undefined);\n                    loadingManagerRef.current = null;\n                }\n            })[\"LDRViewerComponent.useEffect\"];\n        }\n    }[\"LDRViewerComponent.useEffect\"], []);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"LDRViewerComponent.useEffect\": ()=>{\n            if (!containerRef.current || isInitializedRef.current) return;\n            isInitializedRef.current = true;\n            const container = containerRef.current;\n            const width = container.clientWidth;\n            const height = container.clientHeight;\n            const scene = new three__WEBPACK_IMPORTED_MODULE_2__.Scene();\n            scene.background = new three__WEBPACK_IMPORTED_MODULE_2__.Color(0xeeeeee);\n            sceneRef.current = scene;\n            // Camera with settings optimized for large LEGO models\n            const camera = new three__WEBPACK_IMPORTED_MODULE_2__.PerspectiveCamera(45, width / height, 0.1, 50000);\n            camera.position.set(300, 400, 700);\n            cameraRef.current = camera;\n            const renderer = new three__WEBPACK_IMPORTED_MODULE_2__.WebGLRenderer({\n                antialias: true\n            });\n            renderer.setSize(width, height);\n            renderer.setPixelRatio(window.devicePixelRatio);\n            container.appendChild(renderer.domElement);\n            rendererRef.current = renderer;\n            const controls = new three_examples_jsm_controls_OrbitControls_js__WEBPACK_IMPORTED_MODULE_3__.OrbitControls(camera, renderer.domElement);\n            controls.enableDamping = true;\n            controls.dampingFactor = 0.05;\n            controls.enablePan = true;\n            controls.enableRotate = true;\n            controls.enableZoom = true;\n            controls.screenSpacePanning = false;\n            controls.minDistance = 10;\n            controls.maxDistance = 2000;\n            controls.target.set(0, 0, 0);\n            controlsRef.current = controls;\n            // Enhanced lighting for better visibility\n            scene.add(new three__WEBPACK_IMPORTED_MODULE_2__.AmbientLight(0xffffff, 0.9)); // Brighter ambient light\n            // Main directional light\n            const dirLight = new three__WEBPACK_IMPORTED_MODULE_2__.DirectionalLight(0xffffff, 1.0);\n            dirLight.position.set(500, 1000, 500);\n            dirLight.castShadow = false;\n            scene.add(dirLight);\n            // Additional fill lights from different angles\n            const fillLight1 = new three__WEBPACK_IMPORTED_MODULE_2__.DirectionalLight(0xffffff, 0.5);\n            fillLight1.position.set(-500, 500, -500);\n            scene.add(fillLight1);\n            const fillLight2 = new three__WEBPACK_IMPORTED_MODULE_2__.DirectionalLight(0xffffff, 0.5);\n            fillLight2.position.set(500, 500, -500);\n            scene.add(fillLight2);\n            // Add a hemisphere light for more natural lighting\n            const hemiLight = new three__WEBPACK_IMPORTED_MODULE_2__.HemisphereLight(0xffffff, 0xcccccc, 0.4);\n            hemiLight.position.set(0, 500, 0);\n            scene.add(hemiLight);\n            // Grid helper removed\n            // const gridHelper = new THREE.GridHelper(1000, 20);\n            // scene.add(gridHelper);\n            // Add axes helper\n            const axesHelper = new three__WEBPACK_IMPORTED_MODULE_2__.AxesHelper(500);\n            scene.add(axesHelper);\n            const handleResize = {\n                \"LDRViewerComponent.useEffect.handleResize\": ()=>{\n                    if (!containerRef.current || !cameraRef.current || !rendererRef.current) return;\n                    const w = containerRef.current.clientWidth;\n                    const h = containerRef.current.clientHeight;\n                    rendererRef.current.setSize(w, h);\n                    cameraRef.current.aspect = w / h;\n                    cameraRef.current.updateProjectionMatrix();\n                }\n            }[\"LDRViewerComponent.useEffect.handleResize\"];\n            window.addEventListener('resize', handleResize);\n            // Animation loop is now handled in the cube effect\n            console.log('Scene initialized');\n            return ({\n                \"LDRViewerComponent.useEffect\": ()=>{\n                    window.removeEventListener('resize', handleResize);\n                // Keep renderer intact but clean up event listener\n                // if (rendererRef.current && containerRef.current) {\n                //   containerRef.current.removeChild(rendererRef.current.domElement);\n                //   rendererRef.current.dispose();\n                // }\n                // isInitializedRef.current = false;\n                }\n            })[\"LDRViewerComponent.useEffect\"];\n        }\n    }[\"LDRViewerComponent.useEffect\"], []);\n    // Animation loop - using useRef to ensure single instance\n    const animationIdRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const isAnimatingRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"LDRViewerComponent.useEffect\": ()=>{\n            if (!sceneRef.current || !rendererRef.current || !cameraRef.current || !controlsRef.current) return;\n            // Prevent multiple animation loops\n            if (isAnimatingRef.current) {\n                console.log('Animation already running, skipping...');\n                return;\n            }\n            // Commented out cancellation\n            // if (animationIdRef.current !== null) {\n            //   cancelAnimationFrame(animationIdRef.current);\n            // }\n            isAnimatingRef.current = true;\n            const animate = {\n                \"LDRViewerComponent.useEffect.animate\": ()=>{\n                    if (!isAnimatingRef.current) return;\n                    // Check all refs before scheduling next frame\n                    if (!controlsRef.current || !rendererRef.current || !sceneRef.current || !cameraRef.current) {\n                        console.warn('Animation loop stopped: missing refs');\n                        isAnimatingRef.current = false;\n                        return;\n                    }\n                    animationIdRef.current = requestAnimationFrame(animate);\n                    try {\n                        // Only validate scene if we've had recent errors\n                        if (errorCountRef.current > 0 && errorCountRef.current < 5) {\n                            let hasNullChildren = false;\n                            let nullCheckCount = 0;\n                            sceneRef.current.traverse({\n                                \"LDRViewerComponent.useEffect.animate\": (child)=>{\n                                    nullCheckCount++;\n                                    // Check if the object itself has required properties\n                                    if (!child.hasOwnProperty('visible')) {\n                                        console.error('Object missing visible property:', child);\n                                    }\n                                    if (child.children) {\n                                        for(let i = 0; i < child.children.length; i++){\n                                            if (child.children[i] === null || child.children[i] === undefined) {\n                                                console.error('Found null/undefined child in scene at index', i, 'of parent:', child);\n                                                hasNullChildren = true;\n                                                // Remove the null child\n                                                child.children.splice(i, 1);\n                                                i--; // Adjust index after removal\n                                            }\n                                        }\n                                    }\n                                }\n                            }[\"LDRViewerComponent.useEffect.animate\"]);\n                            if (hasNullChildren) {\n                                console.warn('Cleaned null children from scene graph after checking', nullCheckCount, 'objects');\n                            }\n                        }\n                        // Update controls and render\n                        // Validate controls state before updating\n                        if (controlsRef.current) {\n                            // Check if controls target is valid\n                            if (!isFinite(controlsRef.current.target.x) || !isFinite(controlsRef.current.target.y) || !isFinite(controlsRef.current.target.z)) {\n                                console.warn('OrbitControls target became invalid, resetting to origin');\n                                controlsRef.current.target.set(0, 0, 0);\n                            }\n                            controlsRef.current.update();\n                        }\n                        rendererRef.current.render(sceneRef.current, cameraRef.current);\n                        // Reset error counter on successful render\n                        if (errorCountRef.current > 0) {\n                            console.log('Rendering recovered after', errorCountRef.current, 'errors');\n                            errorCountRef.current = 0;\n                        }\n                    } catch (error) {\n                        errorCountRef.current = (errorCountRef.current || 0) + 1;\n                        if (errorCountRef.current === 1) {\n                            // Only log detailed info on first error\n                            console.error('First error in animation loop:', error);\n                            console.error('Scene children count:', sceneRef.current.children.length);\n                            console.error('Scene state:', sceneRef.current);\n                            console.error('Camera state:', cameraRef.current);\n                            console.error('Controls state:', controlsRef.current);\n                            // Log the model group state\n                            if (modelGroupRef.current) {\n                                console.error('Model group state:', modelGroupRef.current);\n                                console.error('Model visible:', modelGroupRef.current.visible);\n                                console.error('Model children count:', modelGroupRef.current.children.length);\n                            }\n                        }\n                        // Stop animation after too many errors\n                        if (errorCountRef.current > 100) {\n                            console.error('Too many render errors, stopping animation loop');\n                            isAnimatingRef.current = false;\n                        }\n                    }\n                }\n            }[\"LDRViewerComponent.useEffect.animate\"];\n            // Start the animation loop\n            animate();\n            console.log('Animation loop started');\n            return ({\n                \"LDRViewerComponent.useEffect\": ()=>{\n                    // Properly clean up animation loop\n                    isAnimatingRef.current = false;\n                    if (animationIdRef.current !== null) {\n                        cancelAnimationFrame(animationIdRef.current);\n                        animationIdRef.current = null;\n                    }\n                }\n            })[\"LDRViewerComponent.useEffect\"];\n        }\n    }[\"LDRViewerComponent.useEffect\"], []);\n    // Test cube commented out - LEGO model should load instead\n    /*\r\n  const cubeRef = useRef<THREE.Mesh | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!sceneRef.current) return;\r\n\r\n    // Prevent adding cube multiple times\r\n    if (cubeRef.current) return;\r\n\r\n    // Add a simple red cube that we know works\r\n    const geometry = new THREE.BoxGeometry(30, 30, 30);\r\n    const material = new THREE.MeshPhongMaterial({\r\n      color: 0xff0000,\r\n      side: THREE.DoubleSide\r\n    });\r\n    const cube = new THREE.Mesh(geometry, material);\r\n    cube.position.set(0, 300, 0);\r\n\r\n    sceneRef.current.add(cube);\r\n\r\n    cubeRef.current = cube;\r\n    console.log('Simple test cube added at:', cube.position);\r\n    console.log('Scene now has', sceneRef.current.children.length, 'children');\r\n\r\n    return () => {\r\n      // Commented out cleanup to keep the cube visible\r\n      // if (sceneRef.current && cube) {\r\n      //   sceneRef.current.remove(cube);  // Also need to prevent removal from scene\r\n      //   geometry.dispose();\r\n      //   material.dispose();\r\n      // }\r\n      // cubeRef.current = null;\r\n    };\r\n  }, []);\r\n  */ // Cube animation commented out since cube is removed\n    /*\r\n  useEffect(() => {\r\n    const animate = () => {\r\n      if (cubeRef.current) {\r\n        cubeRef.current.rotation.x += 0.01;\r\n        cubeRef.current.rotation.y += 0.01;\r\n      }\r\n    };\r\n\r\n    const id = setInterval(animate, 16); // ~60fps\r\n\r\n    // Commented out interval cleanup\r\n    // return () => clearInterval(id);\r\n    return () => {};\r\n  }, []);\r\n  */ // LEGO LOADING CODE\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"LDRViewerComponent.useEffect\": ()=>{\n            // Need either modelPath or ldrawContent\n            if (!modelPath && !ldrawContent || !sceneRef.current || !rendererRef.current || !cameraRef.current) return;\n            // Skip if we're already loading this exact model\n            const currentIdentifier = ldrawContent ? `content-${ldrawContent.substring(0, 100)}` : modelPath;\n            if (currentModelPathRef.current === currentIdentifier && isLoadingRef.current) {\n                console.log('Same model already loading, skipping...');\n                return;\n            }\n            // Skip if this model is already loaded\n            if (currentModelPathRef.current === currentIdentifier && modelGroupRef.current) {\n                console.log('Model already loaded, skipping...');\n                return;\n            }\n            // Prevent concurrent loads\n            if (isLoadingRef.current) {\n                console.log('Another model is loading, skipping...');\n                return;\n            }\n            // Clean up previous model safely\n            if (modelGroupRef.current && sceneRef.current) {\n                console.log('Removing previous model from scene');\n                // Mark as invisible first to prevent render issues\n                modelGroupRef.current.visible = false;\n                // Remove from scene on next tick\n                const modelToRemove = modelGroupRef.current;\n                modelGroupRef.current = null;\n                setTimeout({\n                    \"LDRViewerComponent.useEffect\": ()=>{\n                        if (sceneRef.current && modelToRemove) {\n                            console.log('Actually removing model and disposing resources');\n                            sceneRef.current.remove(modelToRemove);\n                            // Dispose of geometries and materials if needed\n                            modelToRemove.traverse({\n                                \"LDRViewerComponent.useEffect\": (child)=>{\n                                    if (child.geometry) child.geometry.dispose();\n                                    if (child.material) {\n                                        if (Array.isArray(child.material)) {\n                                            child.material.forEach({\n                                                \"LDRViewerComponent.useEffect\": (mat)=>mat.dispose()\n                                            }[\"LDRViewerComponent.useEffect\"]);\n                                        } else {\n                                            child.material.dispose();\n                                        }\n                                    }\n                                }\n                            }[\"LDRViewerComponent.useEffect\"]);\n                            console.log('Model removal complete');\n                        }\n                    }\n                }[\"LDRViewerComponent.useEffect\"], 0);\n            }\n            // Prevent multiple loads of the same model\n            let cancelled = false;\n            isLoadingRef.current = true;\n            currentModelPathRef.current = currentIdentifier || 'generated';\n            const loader = new three_examples_jsm_loaders_LDrawLoader_js__WEBPACK_IMPORTED_MODULE_4__.LDrawLoader(loadingManagerRef.current ?? undefined);\n            // Set the parts library path to the ldraw directory\n            loader.setPartsLibraryPath('/ldraw/');\n            // Set the file map for better part resolution\n            loader.setFileMap({});\n            // Set the conditional line material class (not an instance)\n            loader.setConditionalLineMaterial(three_examples_jsm_materials_LDrawConditionalLineMaterial_js__WEBPACK_IMPORTED_MODULE_5__.LDrawConditionalLineMaterial);\n            console.log(ldrawContent ? 'Loading LDraw from content' : `Loading LDR file: ${modelPath}`);\n            // Try to preload materials first, but don't fail if it doesn't work\n            const materialsPromise = loader.preloadMaterials('/ldraw/LDConfig.ldr').then({\n                \"LDRViewerComponent.useEffect.materialsPromise\": ()=>{\n                    console.log('Materials preloaded successfully');\n                }\n            }[\"LDRViewerComponent.useEffect.materialsPromise\"]).catch({\n                \"LDRViewerComponent.useEffect.materialsPromise\": (err)=>{\n                    console.warn('Could not preload materials, using defaults:', err.message);\n                }\n            }[\"LDRViewerComponent.useEffect.materialsPromise\"]);\n            // Load the model (wait for materials if possible, but don't block)\n            Promise.all([\n                materialsPromise\n            ]).then({\n                \"LDRViewerComponent.useEffect\": ()=>{\n                    if (cancelled) return;\n                    // If we have direct content, parse it; otherwise load from file\n                    if (ldrawContent) {\n                        return loader.parse(ldrawContent, '/');\n                    } else if (modelPath) {\n                        return loader.loadAsync(modelPath);\n                    }\n                    return null;\n                }\n            }[\"LDRViewerComponent.useEffect\"]).then({\n                \"LDRViewerComponent.useEffect\": (group)=>{\n                    if (!group || cancelled) return;\n                    console.log('Model loaded successfully:', group);\n                    isLoadingRef.current = false;\n                    // Fix null materials and children issues\n                    group.traverse({\n                        \"LDRViewerComponent.useEffect\": (child)=>{\n                            // Check for null children\n                            if (child.children) {\n                                const originalLength = child.children.length;\n                                child.children = child.children.filter({\n                                    \"LDRViewerComponent.useEffect\": (c)=>c !== null && c !== undefined\n                                }[\"LDRViewerComponent.useEffect\"]);\n                                if (child.children.length !== originalLength) {\n                                    console.warn('Removed null children from:', child.name || child.uuid);\n                                }\n                            }\n                            // Fix null materials\n                            if (child.isMesh) {\n                                const mesh = child;\n                                if (!mesh.material) {\n                                    // Create a default material if missing\n                                    mesh.material = new three__WEBPACK_IMPORTED_MODULE_2__.MeshPhongMaterial({\n                                        color: 0x808080,\n                                        side: three__WEBPACK_IMPORTED_MODULE_2__.DoubleSide\n                                    });\n                                    console.log('Added default material to mesh:', mesh.name);\n                                } else if (Array.isArray(mesh.material)) {\n                                    // Check array of materials\n                                    mesh.material = mesh.material.map({\n                                        \"LDRViewerComponent.useEffect\": (mat)=>{\n                                            if (!mat) {\n                                                console.log('Replacing null material in array');\n                                                return new three__WEBPACK_IMPORTED_MODULE_2__.MeshPhongMaterial({\n                                                    color: 0x808080,\n                                                    side: three__WEBPACK_IMPORTED_MODULE_2__.DoubleSide\n                                                });\n                                            }\n                                            return mat;\n                                        }\n                                    }[\"LDRViewerComponent.useEffect\"]);\n                                }\n                            }\n                        }\n                    }[\"LDRViewerComponent.useEffect\"]);\n                    // Position model at origin and rotate 180 degrees\n                    group.position.set(0, 0, 0);\n                    // group.rotation.x = Math.PI; // Rotate 180 degrees around X axis\n                    modelGroupRef.current = group;\n                    if (sceneRef.current) {\n                        sceneRef.current.add(group);\n                        console.log('Model added to scene');\n                        console.log('Group children:', group.children.length);\n                        console.log('Group visible:', group.visible);\n                        console.log('Group in scene:', sceneRef.current.children.includes(group));\n                        // Make sure the group is visible\n                        group.visible = true;\n                        group.traverse({\n                            \"LDRViewerComponent.useEffect\": (child)=>{\n                                child.visible = true;\n                            }\n                        }[\"LDRViewerComponent.useEffect\"]);\n                        // Count visible meshes and check materials\n                        let meshCount = 0;\n                        let visibleCount = 0;\n                        group.traverse({\n                            \"LDRViewerComponent.useEffect\": (child)=>{\n                                if (child.isMesh) {\n                                    meshCount++;\n                                    const mesh = child;\n                                    if (mesh.visible) visibleCount++;\n                                    if (!mesh.geometry.boundingBox) {\n                                        mesh.geometry.computeBoundingBox();\n                                    }\n                                    // Log mesh details\n                                    console.log('Mesh details:', {\n                                        name: mesh.name,\n                                        visible: mesh.visible,\n                                        material: mesh.material,\n                                        geometryVertices: mesh.geometry.attributes.position?.count || 0,\n                                        position: mesh.position,\n                                        scale: mesh.scale\n                                    });\n                                    // Make sure mesh has a material\n                                    if (!mesh.material) {\n                                        console.warn('Mesh has no material, adding default');\n                                        mesh.material = new three__WEBPACK_IMPORTED_MODULE_2__.MeshPhongMaterial({\n                                            color: 0xff0000,\n                                            side: three__WEBPACK_IMPORTED_MODULE_2__.DoubleSide\n                                        });\n                                    }\n                                }\n                            }\n                        }[\"LDRViewerComponent.useEffect\"]);\n                        console.log(`Found ${meshCount} meshes, ${visibleCount} visible`);\n                    // Test cube removed - rendering verified to be working\n                    // const testGeometry = new THREE.BoxGeometry(50, 50, 50);\n                    // const testMaterial = new THREE.MeshPhongMaterial({ color: 0x00ff00 });\n                    // const testCube = new THREE.Mesh(testGeometry, testMaterial);\n                    // testCube.position.set(100, 25, 0);\n                    // sceneRef.current.add(testCube);\n                    // console.log('Test cube added at:', testCube.position);\n                    }\n                    // Force update matrices before calculating bounding box\n                    group.updateMatrixWorld(true);\n                    // Calculate bounding box and center camera\n                    const box = new three__WEBPACK_IMPORTED_MODULE_2__.Box3().setFromObject(group);\n                    const center = box.getCenter(new three__WEBPACK_IMPORTED_MODULE_2__.Vector3());\n                    const size = box.getSize(new three__WEBPACK_IMPORTED_MODULE_2__.Vector3());\n                    // Log model information\n                    if (!box.isEmpty() && size.x > 0 && size.y > 0 && size.z > 0) {\n                        console.log('Model center:', center.x, center.y, center.z);\n                        console.log('Model size:', size.x, size.y, size.z);\n                    } else {\n                        console.warn('Model has empty/invalid bounding box');\n                    }\n                    if (controlsRef.current) {\n                        // Just update controls to look at origin\n                        controlsRef.current.target.set(0, 0, 0);\n                        controlsRef.current.update();\n                    }\n                    // The animation loop will handle rendering\n                    console.log('Scene children:', sceneRef.current?.children.length || 0);\n                }\n            }[\"LDRViewerComponent.useEffect\"]).catch({\n                \"LDRViewerComponent.useEffect\": (error)=>{\n                    if (cancelled) return;\n                    console.error('Error loading model:', error);\n                    console.error('Model path:', modelPath);\n                    console.error('Stack trace:', error.stack);\n                    isLoadingRef.current = false;\n                }\n            }[\"LDRViewerComponent.useEffect\"]);\n            // Cleanup function - only remove model if path changes or component unmounts\n            return ({\n                \"LDRViewerComponent.useEffect\": ()=>{\n                    cancelled = true;\n                // Don't clear the model here - it will be cleared when a new model loads\n                // or when the component unmounts\n                }\n            })[\"LDRViewerComponent.useEffect\"];\n        }\n    }[\"LDRViewerComponent.useEffect\"], [\n        modelPath,\n        ldrawContent\n    ]);\n    // Clean up model when component unmounts\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"LDRViewerComponent.useEffect\": ()=>{\n            return ({\n                \"LDRViewerComponent.useEffect\": ()=>{\n                    if (modelGroupRef.current && sceneRef.current) {\n                        // Mark as invisible first\n                        modelGroupRef.current.visible = false;\n                        // Then remove\n                        sceneRef.current.remove(modelGroupRef.current);\n                        modelGroupRef.current = null;\n                    }\n                    isLoadingRef.current = false;\n                    currentModelPathRef.current = '';\n                }\n            })[\"LDRViewerComponent.useEffect\"];\n        }\n    }[\"LDRViewerComponent.useEffect\"], []);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        ref: containerRef,\n        style: {\n            width: '100%',\n            height: '600px',\n            border: '1px solid #ccc',\n            borderRadius: '8px',\n            overflow: 'hidden'\n        }\n    }, void 0, false, {\n        fileName: \"/Users/gnome/lego/brickyard/components/LDRViewer.tsx\",\n        lineNumber: 648,\n        columnNumber: 5\n    }, undefined);\n};\nconst LDRViewer = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.memo)(LDRViewerComponent);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (LDRViewer);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvTERSVmlld2VyLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQXVEO0FBQ3hCO0FBQzhDO0FBQ0w7QUFDb0M7QUFPNUcsTUFBTVEscUJBQStDLENBQUMsRUFBRUMsU0FBUyxFQUFFQyxZQUFZLEVBQUU7SUFDL0UsTUFBTUMsZUFBZVQsNkNBQU1BLENBQWlCO0lBQzVDLE1BQU1VLFdBQVdWLDZDQUFNQSxDQUFxQjtJQUM1QyxNQUFNVyxjQUFjWCw2Q0FBTUEsQ0FBNkI7SUFDdkQsTUFBTVksWUFBWVosNkNBQU1BLENBQWlDO0lBQ3pELE1BQU1hLGNBQWNiLDZDQUFNQSxDQUF1QjtJQUNqRCxNQUFNYyxnQkFBZ0JkLDZDQUFNQSxDQUFxQjtJQUNqRCxNQUFNZSxvQkFBb0JmLDZDQUFNQSxDQUE4QjtJQUM5RCxNQUFNZ0IsZUFBZWhCLDZDQUFNQSxDQUFVO0lBQ3JDLE1BQU1pQixzQkFBc0JqQiw2Q0FBTUEsQ0FBUztJQUMzQyxNQUFNa0IsbUJBQW1CbEIsNkNBQU1BLENBQVU7SUFDekMsTUFBTW1CLGdCQUFnQm5CLDZDQUFNQSxDQUFTO0lBRXJDLG1DQUFtQztJQUNuQ0QsZ0RBQVNBO3dDQUFDO1lBQ1IsSUFBSWdCLGtCQUFrQkssT0FBTyxFQUFFO1lBRS9CLE1BQU1DLFVBQVUsSUFBSW5CLGlEQUFvQjtZQUV4Qyx3RUFBd0U7WUFDeEVtQixRQUFRRSxjQUFjO2dEQUFDLENBQUNDO29CQUN0QixxQ0FBcUM7b0JBRXJDLDRCQUE0QjtvQkFDNUIsSUFBSUMsYUFBYUQsSUFBSUUsT0FBTyxDQUFDLE9BQU87b0JBRXBDLG1FQUFtRTtvQkFDbkUsSUFBSUQsV0FBV0UsUUFBUSxDQUFDLFNBQVNGLFdBQVdHLEtBQUssQ0FBQyxZQUFZO3dCQUM1RCxNQUFNQyxRQUFRSixXQUFXSyxLQUFLLENBQUM7d0JBQy9CLE1BQU1DLFVBQVVGLE1BQU1HLEtBQUssQ0FBQyxDQUFDO3dCQUM3QixJQUFJRCxPQUFPLENB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QVFhLEtBQUssQ0FBQyxnQkFBZ0JBLE1BQU1zRSxLQUFLO29CQUN6Qy9KLGFBQWFJLE9BQU8sR0FBRztnQkFDekI7O1lBRUYsNkVBQTZFO1lBQzdFO2dEQUFPO29CQUNMNkcsWUFBWTtnQkFDWix5RUFBeUU7Z0JBQ3pFLGlDQUFpQztnQkFDbkM7O1FBQ0Y7dUNBQUc7UUFBQzFIO1FBQVdDO0tBQWE7SUFFNUIseUNBQXlDO0lBQ3pDVCxnREFBU0E7d0NBQUM7WUFDUjtnREFBTztvQkFDTCxJQUFJZSxjQUFjTSxPQUFPLElBQUlWLFNBQVNVLE9BQU8sRUFBRTt3QkFDN0MsMEJBQTBCO3dCQUMxQk4sY0FBY00sT0FBTyxDQUFDK0YsT0FBTyxHQUFHO3dCQUNoQyxjQUFjO3dCQUNkekcsU0FBU1UsT0FBTyxDQUFDcUcsTUFBTSxDQUFDM0csY0FBY00sT0FBTzt3QkFDN0NOLGNBQWNNLE9BQU8sR0FBRztvQkFDMUI7b0JBQ0FKLGFBQWFJLE9BQU8sR0FBRztvQkFDdkJILG9CQUFvQkcsT0FBTyxHQUFHO2dCQUNoQzs7UUFDRjt1Q0FBRyxFQUFFO0lBRUwscUJBQ0UsOERBQUM0SjtRQUNDQyxLQUFLeEs7UUFDTHlLLE9BQU87WUFDTHRJLE9BQU87WUFDUEUsUUFBUTtZQUNScUksUUFBUTtZQUNSQyxjQUFjO1lBQ2RDLFVBQVU7UUFDWjs7Ozs7O0FBR047QUFFQSxNQUFNQywwQkFBWXJMLDJDQUFJQSxDQUFDSztBQUN2QixpRUFBZWdMLFNBQVNBLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9nbm9tZS9sZWdvL2JyaWNreWFyZC9jb21wb25lbnRzL0xEUlZpZXdlci50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlUmVmLCBtZW1vIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZSc7XHJcbmltcG9ydCB7IE9yYml0Q29udHJvbHMgfSBmcm9tICd0aHJlZS9leGFtcGxlcy9qc20vY29udHJvbHMvT3JiaXRDb250cm9scy5qcyc7XHJcbmltcG9ydCB7IExEcmF3TG9hZGVyIH0gZnJvbSAndGhyZWUvZXhhbXBsZXMvanNtL2xvYWRlcnMvTERyYXdMb2FkZXIuanMnO1xyXG5pbXBvcnQgeyBMRHJhd0NvbmRpdGlvbmFsTGluZU1hdGVyaWFsIH0gZnJvbSAndGhyZWUvZXhhbXBsZXMvanNtL21hdGVyaWFscy9MRHJhd0NvbmRpdGlvbmFsTGluZU1hdGVyaWFsLmpzJztcclxuXHJcbmludGVyZmFjZSBMRFJWaWV3ZXJQcm9wcyB7XHJcbiAgbW9kZWxQYXRoPzogc3RyaW5nO1xyXG4gIGxkcmF3Q29udGVudD86IHN0cmluZztcclxufVxyXG5cclxuY29uc3QgTERSVmlld2VyQ29tcG9uZW50OiBSZWFjdC5GQzxMRFJWaWV3ZXJQcm9wcz4gPSAoeyBtb2RlbFBhdGgsIGxkcmF3Q29udGVudCB9KSA9PiB7XHJcbiAgY29uc3QgY29udGFpbmVyUmVmID0gdXNlUmVmPEhUTUxEaXZFbGVtZW50PihudWxsKTtcclxuICBjb25zdCBzY2VuZVJlZiA9IHVzZVJlZjxUSFJFRS5TY2VuZSB8IG51bGw+KG51bGwpO1xyXG4gIGNvbnN0IHJlbmRlcmVyUmVmID0gdXNlUmVmPFRIUkVFLldlYkdMUmVuZGVyZXIgfCBudWxsPihudWxsKTtcclxuICBjb25zdCBjYW1lcmFSZWYgPSB1c2VSZWY8VEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEgfCBudWxsPihudWxsKTtcclxuICBjb25zdCBjb250cm9sc1JlZiA9IHVzZVJlZjxPcmJpdENvbnRyb2xzIHwgbnVsbD4obnVsbCk7XHJcbiAgY29uc3QgbW9kZWxHcm91cFJlZiA9IHVzZVJlZjxUSFJFRS5Hcm91cCB8IG51bGw+KG51bGwpO1xyXG4gIGNvbnN0IGxvYWRpbmdNYW5hZ2VyUmVmID0gdXNlUmVmPFRIUkVFLkxvYWRpbmdNYW5hZ2VyIHwgbnVsbD4obnVsbCk7XHJcbiAgY29uc3QgaXNMb2FkaW5nUmVmID0gdXNlUmVmPGJvb2xlYW4+KGZhbHNlKTtcclxuICBjb25zdCBjdXJyZW50TW9kZWxQYXRoUmVmID0gdXNlUmVmPHN0cmluZz4oJycpO1xyXG4gIGNvbnN0IGlzSW5pdGlhbGl6ZWRSZWYgPSB1c2VSZWY8Ym9vbGVhbj4oZmFsc2UpO1xyXG4gIGNvbnN0IGVycm9yQ291bnRSZWYgPSB1c2VSZWY8bnVtYmVyPigwKTtcclxuXHJcbiAgLy8gQ3JlYXRlIGxvYWRpbmcgbWFuYWdlciBvbmx5IG9uY2VcclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgaWYgKGxvYWRpbmdNYW5hZ2VyUmVmLmN1cnJlbnQpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBtYW5hZ2VyID0gbmV3IFRIUkVFLkxvYWRpbmdNYW5hZ2VyKCk7XHJcblxyXG4gICAgLy8gSW1wbGVtZW50IHBhdGggcmVzb2x1dGlvbiBzdHJhdGVneSBzaW1pbGFyIHRvIFRocmVlLmpzIHBhY2tMRHJhd01vZGVsXHJcbiAgICBtYW5hZ2VyLnNldFVSTE1vZGlmaWVyKCh1cmwpID0+IHtcclxuICAgICAgLy8gY29uc29sZS5sb2coJ09yaWdpbmFsIFVSTDonLCB1cmwpO1xyXG5cclxuICAgICAgLy8gTm9ybWFsaXplIHBhdGggc2VwYXJhdG9yc1xyXG4gICAgICBsZXQgbm9ybWFsaXplZCA9IHVybC5yZXBsYWNlKC9cXFxcL2csICcvJyk7XHJcblxyXG4gICAgICAvLyBIYW5kbGUgc1xcIHByZWZpeCBmb3Igc3VicGFydHMgKGNvbnZlcnQgc1xcZmlsZS5kYXQgdG8gcy9maWxlLmRhdClcclxuICAgICAgaWYgKG5vcm1hbGl6ZWQuaW5jbHVkZXMoJ3MvJykgfHwgbm9ybWFsaXplZC5tYXRjaCgvc1tcXFxcXFwvXS8pKSB7XHJcbiAgICAgICAgY29uc3QgcGFydHMgPSBub3JtYWxpemVkLnNwbGl0KC9bXFxcXFxcL10vKTtcclxuICAgICAgICBjb25zdCBsYXN0VHdvID0gcGFydHMuc2xpY2UoLTIpO1xyXG4gICAgICAgIGlmIChsYXN0VHdvWzBdID09PSAncycpIHtcclxuICAgICAgICAgIC8vIFRoaXMgaXMgYSBzdWJwYXJ0IHJlZmVyZW5jZVxyXG4gICAgICAgICAgbm9ybWFsaXplZCA9IGAvbGRyYXcvcGFydHMvcy8ke2xhc3RUd29bMV19YDtcclxuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdTdWJwYXJ0IGRldGVjdGVkLCBub3JtYWxpemVkIHRvOicsIG5vcm1hbGl6ZWQpO1xyXG4gICAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBFeHRyYWN0IHRoZSBmaWxlbmFtZSBhbmQgY2hlY2sgZm9yIHN1YmRpcmVjdG9yeSAobGlrZSBzLylcclxuICAgICAgY29uc3QgdXJsUGFydHMgPSBub3JtYWxpemVkLnNwbGl0KCcvJyk7XHJcbiAgICAgIGNvbnN0IGZpbGVuYW1lID0gdXJsUGFydHNbdXJsUGFydHMubGVuZ3RoIC0gMV0udG9Mb3dlckNhc2UoKTtcclxuICAgICAgY29uc3QgaGFzU3ViZGlyID0gdXJsUGFydHMubGVuZ3RoID49IDIgJiYgdXJsUGFydHNbdXJsUGFydHMubGVuZ3RoIC0gMl0gPT09ICdzJztcclxuXHJcbiAgICAgIC8vIERlZmluZSBwb3NzaWJsZSBwYXRoIHByZWZpeGVzIHRvIHRyeVxyXG4gICAgICBjb25zdCBwYXRoUHJlZml4ZXMgPSBbXHJcbiAgICAgICAgJy9vdXRwdXQvJywgICAgICAgICAgLy8gT3V0cHV0IGRpcmVjdG9yeSBmb3IgZ2VuZXJhdGVkIG1vZGVsc1xyXG4gICAgICAgICcvbGRyYXcvJywgICAgICAgICAgIC8vIERpcmVjdCBwYXRoXHJcbiAgICAgICAgJy9sZHJhdy9wLycsICAgICAgICAgLy8gUHJpbWl0aXZlc1xyXG4gICAgICAgICcvbGRyYXcvcGFydHMvJywgICAgIC8vIFBhcnRzXHJcbiAgICAgIF07XHJcblxyXG4gICAgICAvLyBJZiB0aGUgVVJMIGFscmVhZHkgaGFzIGEgdmFsaWQgcHJlZml4LCBjbGVhbiBpdCB1cFxyXG4gICAgICBmb3IgKGNvbnN0IHByZWZpeCBvZiBwYXRoUHJlZml4ZXMpIHtcclxuICAgICAgICBpZiAobm9ybWFsaXplZC5pbmNsdWRlcyhwcmVmaXgpKSB7XHJcbiAgICAgICAgICAvLyBDbGVhbiB1cCBhbnkgZHVwbGljYXRlIHBhdGggc2VnbWVudHNcclxuICAgICAgICAgIG5vcm1hbGl6ZWQgPSBub3JtYWxpemVkLnJlcGxhY2UoL1xcL2xkcmF3XFwvcGFydHNcXC9wYXJ0c1xcLy9nLCAnL2xkcmF3L3BhcnRzLycpO1xyXG4gICAgICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQucmVwbGFjZSgvXFwvbGRyYXdcXC9wXFwvcFxcLy9nLCAnL2xkcmF3L3AvJyk7XHJcbiAgICAgICAgICBub3JtYWxpemVkID0gbm9ybWFsaXplZC5yZXBsYWNlKC9cXC9vdXRwdXRcXC9vdXRwdXRcXC8vZywgJy9vdXRwdXQvJyk7XHJcblxyXG4gICAgICAgICAgLy8gUmVtb3ZlIGFueSByZWR1bmRhbnQgcGF0aCBjb21iaW5hdGlvbnMgYnV0IHByZXNlcnZlIHMvIHN1YmRpcmVjdG9yeVxyXG4gICAgICAgICAgaWYgKCFub3JtYWxpemVkLmluY2x1ZGVzKCcvcy8nKSkge1xyXG4gICAgICAgICAgICBub3JtYWxpemVkID0gbm9ybWFsaXplZC5yZXBsYWNlKC9cXC9sZHJhd1xcL3BhcnRzXFwvcFxcLy9nLCAnL2xkcmF3L3AvJyk7XHJcbiAgICAgICAgICAgIG5vcm1hbGl6ZWQgPSBub3JtYWxpemVkLnJlcGxhY2UoL1xcL291dHB1dFxcL3BcXC8vZywgJy9sZHJhdy9wLycpO1xyXG4gICAgICAgICAgICBub3JtYWxpemVkID0gbm9ybWFsaXplZC5yZXBsYWNlKC9cXC9sZHJhd1xcL3BcXC9wYXJ0c1xcLy9nLCAnL2xkcmF3L3BhcnRzLycpO1xyXG4gICAgICAgICAgICBub3JtYWxpemVkID0gbm9ybWFsaXplZC5yZXBsYWNlKC9cXC9vdXRwdXRcXC9wYXJ0c1xcLy9nLCAnL2xkcmF3L3BhcnRzLycpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gSGFuZGxlIHN1YnBhcnRzIGluIHMvIGRpcmVjdG9yeVxyXG4gICAgICAgICAgICBub3JtYWxpemVkID0gbm9ybWFsaXplZC5yZXBsYWNlKC9cXC9sZHJhd1xcL3BhcnRzXFwvcGFydHNcXC9zXFwvL2csICcvbGRyYXcvcGFydHMvcy8nKTtcclxuICAgICAgICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQucmVwbGFjZSgvXFwvbGRyYXdcXC9wXFwvcGFydHNcXC9zXFwvL2csICcvbGRyYXcvcGFydHMvcy8nKTtcclxuICAgICAgICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQucmVwbGFjZSgvXFwvb3V0cHV0XFwvcGFydHNcXC9zXFwvL2csICcvbGRyYXcvcGFydHMvcy8nKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZygnTm9ybWFsaXplZCBVUkw6Jywgbm9ybWFsaXplZCk7XHJcbiAgICAgICAgICByZXR1cm4gbm9ybWFsaXplZDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIElmIG5vIHZhbGlkIHByZWZpeCBmb3VuZCwgdHJ5IHRvIGNvbnN0cnVjdCB0aGUgcGF0aFxyXG4gICAgICAvLyBUaGlzIGhhbmRsZXMgY2FzZXMgd2hlcmUgdGhlIFVSTCBpcyBqdXN0IGEgZmlsZW5hbWUgb3IgcmVsYXRpdmUgcGF0aFxyXG4gICAgICBpZiAoIW5vcm1hbGl6ZWQuc3RhcnRzV2l0aCgnL2xkcmF3LycpKSB7XHJcbiAgICAgICAgLy8gSGFuZGxlIHN1YnBhcnRzIChmaWxlcyBpbiBzLyBkaXJlY3RvcnkpXHJcbiAgICAgICAgaWYgKGhhc1N1YmRpcikge1xyXG4gICAgICAgICAgbm9ybWFsaXplZCA9IGAvbGRyYXcvcGFydHMvcy8ke2ZpbGVuYW1lfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYSBwcmltaXRpdmUgKHVzdWFsbHkgc3RhcnQgd2l0aCBudW1iZXJzIG9yIHNwZWNpZmljIHBhdHRlcm5zKVxyXG4gICAgICAgIGVsc2UgaWYgKGZpbGVuYW1lLm1hdGNoKC9eXFxkLykgfHwgZmlsZW5hbWUuc3RhcnRzV2l0aCgnc3R1ZCcpIHx8IGZpbGVuYW1lLnN0YXJ0c1dpdGgoJ2VkZ2UnKSkge1xyXG4gICAgICAgICAgbm9ybWFsaXplZCA9IGAvbGRyYXcvcC8ke2ZpbGVuYW1lfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIERlZmF1bHQgdG8gcGFydHMgZGlyZWN0b3J5IGZvciBvdGhlciAuZGF0IGZpbGVzXHJcbiAgICAgICAgZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5kYXQnKSkge1xyXG4gICAgICAgICAgbm9ybWFsaXplZCA9IGAvbGRyYXcvcGFydHMvJHtmaWxlbmFtZX1gO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBGb3IgTERSIGZpbGVzLCB1c2Ugb3V0cHV0IGRpcmVjdG9yeVxyXG4gICAgICAgIGVsc2UgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcubGRyJykgfHwgZmlsZW5hbWUuZW5kc1dpdGgoJy5tcGQnKSkge1xyXG4gICAgICAgICAgbm9ybWFsaXplZCA9IGAvb3V0cHV0LyR7ZmlsZW5hbWV9YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0NvbnN0cnVjdGVkIFVSTDonLCBub3JtYWxpemVkKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIG5vcm1hbGl6ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsb2FkaW5nTWFuYWdlclJlZi5jdXJyZW50ID0gbWFuYWdlcjtcclxuXHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICBtYW5hZ2VyLnNldFVSTE1vZGlmaWVyKHVuZGVmaW5lZCk7XHJcbiAgICAgIGxvYWRpbmdNYW5hZ2VyUmVmLmN1cnJlbnQgPSBudWxsO1xyXG4gICAgfTtcclxuICB9LCBbXSk7XHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBpZiAoIWNvbnRhaW5lclJlZi5jdXJyZW50IHx8IGlzSW5pdGlhbGl6ZWRSZWYuY3VycmVudCkgcmV0dXJuO1xyXG5cclxuICAgIGlzSW5pdGlhbGl6ZWRSZWYuY3VycmVudCA9IHRydWU7XHJcblxyXG4gICAgY29uc3QgY29udGFpbmVyID0gY29udGFpbmVyUmVmLmN1cnJlbnQ7XHJcbiAgICBjb25zdCB3aWR0aCA9IGNvbnRhaW5lci5jbGllbnRXaWR0aDtcclxuICAgIGNvbnN0IGhlaWdodCA9IGNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcblxyXG4gICAgY29uc3Qgc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKTtcclxuICAgIHNjZW5lLmJhY2tncm91bmQgPSBuZXcgVEhSRUUuQ29sb3IoMHhlZWVlZWUpO1xyXG4gICAgc2NlbmVSZWYuY3VycmVudCA9IHNjZW5lO1xyXG5cclxuICAgIC8vIENhbWVyYSB3aXRoIHNldHRpbmdzIG9wdGltaXplZCBmb3IgbGFyZ2UgTEVHTyBtb2RlbHNcclxuICAgIGNvbnN0IGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg0NSwgd2lkdGggLyBoZWlnaHQsIDAuMSwgNTAwMDApO1xyXG4gICAgY2FtZXJhLnBvc2l0aW9uLnNldCgzMDAsIDQwMCwgNzAwKTtcclxuICAgIGNhbWVyYVJlZi5jdXJyZW50ID0gY2FtZXJhO1xyXG5cclxuICAgIGNvbnN0IHJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoeyBhbnRpYWxpYXM6IHRydWUgfSk7XHJcbiAgICByZW5kZXJlci5zZXRTaXplKHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgcmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7XHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocmVuZGVyZXIuZG9tRWxlbWVudCk7XHJcbiAgICByZW5kZXJlclJlZi5jdXJyZW50ID0gcmVuZGVyZXI7XHJcblxyXG4gICAgY29uc3QgY29udHJvbHMgPSBuZXcgT3JiaXRDb250cm9scyhjYW1lcmEsIHJlbmRlcmVyLmRvbUVsZW1lbnQpO1xyXG4gICAgY29udHJvbHMuZW5hYmxlRGFtcGluZyA9IHRydWU7XHJcbiAgICBjb250cm9scy5kYW1waW5nRmFjdG9yID0gMC4wNTtcclxuICAgIGNvbnRyb2xzLmVuYWJsZVBhbiA9IHRydWU7XHJcbiAgICBjb250cm9scy5lbmFibGVSb3RhdGUgPSB0cnVlO1xyXG4gICAgY29udHJvbHMuZW5hYmxlWm9vbSA9IHRydWU7XHJcbiAgICBjb250cm9scy5zY3JlZW5TcGFjZVBhbm5pbmcgPSBmYWxzZTtcclxuICAgIGNvbnRyb2xzLm1pbkRpc3RhbmNlID0gMTA7XHJcbiAgICBjb250cm9scy5tYXhEaXN0YW5jZSA9IDIwMDA7XHJcbiAgICBjb250cm9scy50YXJnZXQuc2V0KDAsIDAsIDApO1xyXG4gICAgY29udHJvbHNSZWYuY3VycmVudCA9IGNvbnRyb2xzO1xyXG5cclxuICAgIC8vIEVuaGFuY2VkIGxpZ2h0aW5nIGZvciBiZXR0ZXIgdmlzaWJpbGl0eVxyXG4gICAgc2NlbmUuYWRkKG5ldyBUSFJFRS5BbWJpZW50TGlnaHQoMHhmZmZmZmYsIDAuOSkpOyAvLyBCcmlnaHRlciBhbWJpZW50IGxpZ2h0XHJcblxyXG4gICAgLy8gTWFpbiBkaXJlY3Rpb25hbCBsaWdodFxyXG4gICAgY29uc3QgZGlyTGlnaHQgPSBuZXcgVEhSRUUuRGlyZWN0aW9uYWxMaWdodCgweGZmZmZmZiwgMS4wKTtcclxuICAgIGRpckxpZ2h0LnBvc2l0aW9uLnNldCg1MDAsIDEwMDAsIDUwMCk7XHJcbiAgICBkaXJMaWdodC5jYXN0U2hhZG93ID0gZmFsc2U7XHJcbiAgICBzY2VuZS5hZGQoZGlyTGlnaHQpO1xyXG5cclxuICAgIC8vIEFkZGl0aW9uYWwgZmlsbCBsaWdodHMgZnJvbSBkaWZmZXJlbnQgYW5nbGVzXHJcbiAgICBjb25zdCBmaWxsTGlnaHQxID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoMHhmZmZmZmYsIDAuNSk7XHJcbiAgICBmaWxsTGlnaHQxLnBvc2l0aW9uLnNldCgtNTAwLCA1MDAsIC01MDApO1xyXG4gICAgc2NlbmUuYWRkKGZpbGxMaWdodDEpO1xyXG5cclxuICAgIGNvbnN0IGZpbGxMaWdodDIgPSBuZXcgVEhSRUUuRGlyZWN0aW9uYWxMaWdodCgweGZmZmZmZiwgMC41KTtcclxuICAgIGZpbGxMaWdodDIucG9zaXRpb24uc2V0KDUwMCwgNTAwLCAtNTAwKTtcclxuICAgIHNjZW5lLmFkZChmaWxsTGlnaHQyKTtcclxuXHJcbiAgICAvLyBBZGQgYSBoZW1pc3BoZXJlIGxpZ2h0IGZvciBtb3JlIG5hdHVyYWwgbGlnaHRpbmdcclxuICAgIGNvbnN0IGhlbWlMaWdodCA9IG5ldyBUSFJFRS5IZW1pc3BoZXJlTGlnaHQoMHhmZmZmZmYsIDB4Y2NjY2NjLCAwLjQpO1xyXG4gICAgaGVtaUxpZ2h0LnBvc2l0aW9uLnNldCgwLCA1MDAsIDApO1xyXG4gICAgc2NlbmUuYWRkKGhlbWlMaWdodCk7XHJcblxyXG4gICAgLy8gR3JpZCBoZWxwZXIgcmVtb3ZlZFxyXG4gICAgLy8gY29uc3QgZ3JpZEhlbHBlciA9IG5ldyBUSFJFRS5HcmlkSGVscGVyKDEwMDAsIDIwKTtcclxuICAgIC8vIHNjZW5lLmFkZChncmlkSGVscGVyKTtcclxuXHJcbiAgICAvLyBBZGQgYXhlcyBoZWxwZXJcclxuICAgIGNvbnN0IGF4ZXNIZWxwZXIgPSBuZXcgVEhSRUUuQXhlc0hlbHBlcig1MDApO1xyXG4gICAgc2NlbmUuYWRkKGF4ZXNIZWxwZXIpO1xyXG5cclxuICAgIGNvbnN0IGhhbmRsZVJlc2l6ZSA9ICgpID0+IHtcclxuICAgICAgaWYgKCFjb250YWluZXJSZWYuY3VycmVudCB8fCAhY2FtZXJhUmVmLmN1cnJlbnQgfHwgIXJlbmRlcmVyUmVmLmN1cnJlbnQpIHJldHVybjtcclxuICAgICAgY29uc3QgdyA9IGNvbnRhaW5lclJlZi5jdXJyZW50LmNsaWVudFdpZHRoO1xyXG4gICAgICBjb25zdCBoID0gY29udGFpbmVyUmVmLmN1cnJlbnQuY2xpZW50SGVpZ2h0O1xyXG4gICAgICByZW5kZXJlclJlZi5jdXJyZW50LnNldFNpemUodywgaCk7XHJcbiAgICAgIGNhbWVyYVJlZi5jdXJyZW50LmFzcGVjdCA9IHcgLyBoO1xyXG4gICAgICBjYW1lcmFSZWYuY3VycmVudC51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBoYW5kbGVSZXNpemUpO1xyXG5cclxuICAgIC8vIEFuaW1hdGlvbiBsb29wIGlzIG5vdyBoYW5kbGVkIGluIHRoZSBjdWJlIGVmZmVjdFxyXG4gICAgY29uc29sZS5sb2coJ1NjZW5lIGluaXRpYWxpemVkJyk7XHJcblxyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGhhbmRsZVJlc2l6ZSk7XHJcbiAgICAgIC8vIEtlZXAgcmVuZGVyZXIgaW50YWN0IGJ1dCBjbGVhbiB1cCBldmVudCBsaXN0ZW5lclxyXG4gICAgICAvLyBpZiAocmVuZGVyZXJSZWYuY3VycmVudCAmJiBjb250YWluZXJSZWYuY3VycmVudCkge1xyXG4gICAgICAvLyAgIGNvbnRhaW5lclJlZi5jdXJyZW50LnJlbW92ZUNoaWxkKHJlbmRlcmVyUmVmLmN1cnJlbnQuZG9tRWxlbWVudCk7XHJcbiAgICAgIC8vICAgcmVuZGVyZXJSZWYuY3VycmVudC5kaXNwb3NlKCk7XHJcbiAgICAgIC8vIH1cclxuICAgICAgLy8gaXNJbml0aWFsaXplZFJlZi5jdXJyZW50ID0gZmFsc2U7XHJcbiAgICB9O1xyXG4gIH0sIFtdKTtcclxuXHJcbiAgLy8gQW5pbWF0aW9uIGxvb3AgLSB1c2luZyB1c2VSZWYgdG8gZW5zdXJlIHNpbmdsZSBpbnN0YW5jZVxyXG4gIGNvbnN0IGFuaW1hdGlvbklkUmVmID0gdXNlUmVmPG51bWJlciB8IG51bGw+KG51bGwpO1xyXG4gIGNvbnN0IGlzQW5pbWF0aW5nUmVmID0gdXNlUmVmPGJvb2xlYW4+KGZhbHNlKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmICghc2NlbmVSZWYuY3VycmVudCB8fCAhcmVuZGVyZXJSZWYuY3VycmVudCB8fCAhY2FtZXJhUmVmLmN1cnJlbnQgfHwgIWNvbnRyb2xzUmVmLmN1cnJlbnQpIHJldHVybjtcclxuXHJcbiAgICAvLyBQcmV2ZW50IG11bHRpcGxlIGFuaW1hdGlvbiBsb29wc1xyXG4gICAgaWYgKGlzQW5pbWF0aW5nUmVmLmN1cnJlbnQpIHtcclxuICAgICAgY29uc29sZS5sb2coJ0FuaW1hdGlvbiBhbHJlYWR5IHJ1bm5pbmcsIHNraXBwaW5nLi4uJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDb21tZW50ZWQgb3V0IGNhbmNlbGxhdGlvblxyXG4gICAgLy8gaWYgKGFuaW1hdGlvbklkUmVmLmN1cnJlbnQgIT09IG51bGwpIHtcclxuICAgIC8vICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoYW5pbWF0aW9uSWRSZWYuY3VycmVudCk7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgaXNBbmltYXRpbmdSZWYuY3VycmVudCA9IHRydWU7XHJcblxyXG4gICAgY29uc3QgYW5pbWF0ZSA9ICgpID0+IHtcclxuICAgICAgaWYgKCFpc0FuaW1hdGluZ1JlZi5jdXJyZW50KSByZXR1cm47XHJcblxyXG4gICAgICAvLyBDaGVjayBhbGwgcmVmcyBiZWZvcmUgc2NoZWR1bGluZyBuZXh0IGZyYW1lXHJcbiAgICAgIGlmICghY29udHJvbHNSZWYuY3VycmVudCB8fCAhcmVuZGVyZXJSZWYuY3VycmVudCB8fCAhc2NlbmVSZWYuY3VycmVudCB8fCAhY2FtZXJhUmVmLmN1cnJlbnQpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ0FuaW1hdGlvbiBsb29wIHN0b3BwZWQ6IG1pc3NpbmcgcmVmcycpO1xyXG4gICAgICAgIGlzQW5pbWF0aW5nUmVmLmN1cnJlbnQgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFuaW1hdGlvbklkUmVmLmN1cnJlbnQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZSk7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIE9ubHkgdmFsaWRhdGUgc2NlbmUgaWYgd2UndmUgaGFkIHJlY2VudCBlcnJvcnNcclxuICAgICAgICBpZiAoZXJyb3JDb3VudFJlZi5jdXJyZW50ID4gMCAmJiBlcnJvckNvdW50UmVmLmN1cnJlbnQgPCA1KSB7XHJcbiAgICAgICAgICBsZXQgaGFzTnVsbENoaWxkcmVuID0gZmFsc2U7XHJcbiAgICAgICAgICBsZXQgbnVsbENoZWNrQ291bnQgPSAwO1xyXG4gICAgICAgICAgc2NlbmVSZWYuY3VycmVudC50cmF2ZXJzZSgoY2hpbGQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBudWxsQ2hlY2tDb3VudCsrO1xyXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgb2JqZWN0IGl0c2VsZiBoYXMgcmVxdWlyZWQgcHJvcGVydGllc1xyXG4gICAgICAgICAgICBpZiAoIWNoaWxkLmhhc093blByb3BlcnR5KCd2aXNpYmxlJykpIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdPYmplY3QgbWlzc2luZyB2aXNpYmxlIHByb3BlcnR5OicsIGNoaWxkKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGNoaWxkLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZC5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkLmNoaWxkcmVuW2ldID09PSBudWxsIHx8IGNoaWxkLmNoaWxkcmVuW2ldID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRm91bmQgbnVsbC91bmRlZmluZWQgY2hpbGQgaW4gc2NlbmUgYXQgaW5kZXgnLCBpLCAnb2YgcGFyZW50OicsIGNoaWxkKTtcclxuICAgICAgICAgICAgICAgICAgaGFzTnVsbENoaWxkcmVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBudWxsIGNoaWxkXHJcbiAgICAgICAgICAgICAgICAgIGNoaWxkLmNoaWxkcmVuLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgICAgaS0tOyAvLyBBZGp1c3QgaW5kZXggYWZ0ZXIgcmVtb3ZhbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgaWYgKGhhc051bGxDaGlsZHJlbikge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0NsZWFuZWQgbnVsbCBjaGlsZHJlbiBmcm9tIHNjZW5lIGdyYXBoIGFmdGVyIGNoZWNraW5nJywgbnVsbENoZWNrQ291bnQsICdvYmplY3RzJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBVcGRhdGUgY29udHJvbHMgYW5kIHJlbmRlclxyXG4gICAgICAgIC8vIFZhbGlkYXRlIGNvbnRyb2xzIHN0YXRlIGJlZm9yZSB1cGRhdGluZ1xyXG4gICAgICAgIGlmIChjb250cm9sc1JlZi5jdXJyZW50KSB7XHJcbiAgICAgICAgICAvLyBDaGVjayBpZiBjb250cm9scyB0YXJnZXQgaXMgdmFsaWRcclxuICAgICAgICAgIGlmICghaXNGaW5pdGUoY29udHJvbHNSZWYuY3VycmVudC50YXJnZXQueCkgfHxcclxuICAgICAgICAgICAgICAhaXNGaW5pdGUoY29udHJvbHNSZWYuY3VycmVudC50YXJnZXQueSkgfHxcclxuICAgICAgICAgICAgICAhaXNGaW5pdGUoY29udHJvbHNSZWYuY3VycmVudC50YXJnZXQueikpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdPcmJpdENvbnRyb2xzIHRhcmdldCBiZWNhbWUgaW52YWxpZCwgcmVzZXR0aW5nIHRvIG9yaWdpbicpO1xyXG4gICAgICAgICAgICBjb250cm9sc1JlZi5jdXJyZW50LnRhcmdldC5zZXQoMCwgMCwgMCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgY29udHJvbHNSZWYuY3VycmVudC51cGRhdGUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJlbmRlcmVyUmVmLmN1cnJlbnQucmVuZGVyKHNjZW5lUmVmLmN1cnJlbnQsIGNhbWVyYVJlZi5jdXJyZW50KTtcclxuXHJcbiAgICAgICAgLy8gUmVzZXQgZXJyb3IgY291bnRlciBvbiBzdWNjZXNzZnVsIHJlbmRlclxyXG4gICAgICAgIGlmIChlcnJvckNvdW50UmVmLmN1cnJlbnQgPiAwKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnUmVuZGVyaW5nIHJlY292ZXJlZCBhZnRlcicsIGVycm9yQ291bnRSZWYuY3VycmVudCwgJ2Vycm9ycycpO1xyXG4gICAgICAgICAgZXJyb3JDb3VudFJlZi5jdXJyZW50ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgZXJyb3JDb3VudFJlZi5jdXJyZW50ID0gKGVycm9yQ291bnRSZWYuY3VycmVudCB8fCAwKSArIDE7XHJcblxyXG4gICAgICAgIGlmIChlcnJvckNvdW50UmVmLmN1cnJlbnQgPT09IDEpIHtcclxuICAgICAgICAgIC8vIE9ubHkgbG9nIGRldGFpbGVkIGluZm8gb24gZmlyc3QgZXJyb3JcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZpcnN0IGVycm9yIGluIGFuaW1hdGlvbiBsb29wOicsIGVycm9yKTtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NjZW5lIGNoaWxkcmVuIGNvdW50OicsIHNjZW5lUmVmLmN1cnJlbnQuY2hpbGRyZW4ubGVuZ3RoKTtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NjZW5lIHN0YXRlOicsIHNjZW5lUmVmLmN1cnJlbnQpO1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignQ2FtZXJhIHN0YXRlOicsIGNhbWVyYVJlZi5jdXJyZW50KTtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NvbnRyb2xzIHN0YXRlOicsIGNvbnRyb2xzUmVmLmN1cnJlbnQpO1xyXG5cclxuICAgICAgICAgIC8vIExvZyB0aGUgbW9kZWwgZ3JvdXAgc3RhdGVcclxuICAgICAgICAgIGlmIChtb2RlbEdyb3VwUmVmLmN1cnJlbnQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTW9kZWwgZ3JvdXAgc3RhdGU6JywgbW9kZWxHcm91cFJlZi5jdXJyZW50KTtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTW9kZWwgdmlzaWJsZTonLCBtb2RlbEdyb3VwUmVmLmN1cnJlbnQudmlzaWJsZSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01vZGVsIGNoaWxkcmVuIGNvdW50OicsIG1vZGVsR3JvdXBSZWYuY3VycmVudC5jaGlsZHJlbi5sZW5ndGgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU3RvcCBhbmltYXRpb24gYWZ0ZXIgdG9vIG1hbnkgZXJyb3JzXHJcbiAgICAgICAgaWYgKGVycm9yQ291bnRSZWYuY3VycmVudCA+IDEwMCkge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignVG9vIG1hbnkgcmVuZGVyIGVycm9ycywgc3RvcHBpbmcgYW5pbWF0aW9uIGxvb3AnKTtcclxuICAgICAgICAgIGlzQW5pbWF0aW5nUmVmLmN1cnJlbnQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gU3RhcnQgdGhlIGFuaW1hdGlvbiBsb29wXHJcbiAgICBhbmltYXRlKCk7XHJcbiAgICBjb25zb2xlLmxvZygnQW5pbWF0aW9uIGxvb3Agc3RhcnRlZCcpO1xyXG5cclxuICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgIC8vIFByb3Blcmx5IGNsZWFuIHVwIGFuaW1hdGlvbiBsb29wXHJcbiAgICAgIGlzQW5pbWF0aW5nUmVmLmN1cnJlbnQgPSBmYWxzZTtcclxuICAgICAgaWYgKGFuaW1hdGlvbklkUmVmLmN1cnJlbnQgIT09IG51bGwpIHtcclxuICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShhbmltYXRpb25JZFJlZi5jdXJyZW50KTtcclxuICAgICAgICBhbmltYXRpb25JZFJlZi5jdXJyZW50ID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9LCBbXSk7XHJcblxyXG4gIC8vIFRlc3QgY3ViZSBjb21tZW50ZWQgb3V0IC0gTEVHTyBtb2RlbCBzaG91bGQgbG9hZCBpbnN0ZWFkXHJcbiAgLypcclxuICBjb25zdCBjdWJlUmVmID0gdXNlUmVmPFRIUkVFLk1lc2ggfCBudWxsPihudWxsKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmICghc2NlbmVSZWYuY3VycmVudCkgcmV0dXJuO1xyXG5cclxuICAgIC8vIFByZXZlbnQgYWRkaW5nIGN1YmUgbXVsdGlwbGUgdGltZXNcclxuICAgIGlmIChjdWJlUmVmLmN1cnJlbnQpIHJldHVybjtcclxuXHJcbiAgICAvLyBBZGQgYSBzaW1wbGUgcmVkIGN1YmUgdGhhdCB3ZSBrbm93IHdvcmtzXHJcbiAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSgzMCwgMzAsIDMwKTtcclxuICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHtcclxuICAgICAgY29sb3I6IDB4ZmYwMDAwLFxyXG4gICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGN1YmUgPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xyXG4gICAgY3ViZS5wb3NpdGlvbi5zZXQoMCwgMzAwLCAwKTtcclxuXHJcbiAgICBzY2VuZVJlZi5jdXJyZW50LmFkZChjdWJlKTtcclxuXHJcbiAgICBjdWJlUmVmLmN1cnJlbnQgPSBjdWJlO1xyXG4gICAgY29uc29sZS5sb2coJ1NpbXBsZSB0ZXN0IGN1YmUgYWRkZWQgYXQ6JywgY3ViZS5wb3NpdGlvbik7XHJcbiAgICBjb25zb2xlLmxvZygnU2NlbmUgbm93IGhhcycsIHNjZW5lUmVmLmN1cnJlbnQuY2hpbGRyZW4ubGVuZ3RoLCAnY2hpbGRyZW4nKTtcclxuXHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAvLyBDb21tZW50ZWQgb3V0IGNsZWFudXAgdG8ga2VlcCB0aGUgY3ViZSB2aXNpYmxlXHJcbiAgICAgIC8vIGlmIChzY2VuZVJlZi5jdXJyZW50ICYmIGN1YmUpIHtcclxuICAgICAgLy8gICBzY2VuZVJlZi5jdXJyZW50LnJlbW92ZShjdWJlKTsgIC8vIEFsc28gbmVlZCB0byBwcmV2ZW50IHJlbW92YWwgZnJvbSBzY2VuZVxyXG4gICAgICAvLyAgIGdlb21ldHJ5LmRpc3Bvc2UoKTtcclxuICAgICAgLy8gICBtYXRlcmlhbC5kaXNwb3NlKCk7XHJcbiAgICAgIC8vIH1cclxuICAgICAgLy8gY3ViZVJlZi5jdXJyZW50ID0gbnVsbDtcclxuICAgIH07XHJcbiAgfSwgW10pO1xyXG4gICovXHJcblxyXG4gIC8vIEN1YmUgYW5pbWF0aW9uIGNvbW1lbnRlZCBvdXQgc2luY2UgY3ViZSBpcyByZW1vdmVkXHJcbiAgLypcclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgY29uc3QgYW5pbWF0ZSA9ICgpID0+IHtcclxuICAgICAgaWYgKGN1YmVSZWYuY3VycmVudCkge1xyXG4gICAgICAgIGN1YmVSZWYuY3VycmVudC5yb3RhdGlvbi54ICs9IDAuMDE7XHJcbiAgICAgICAgY3ViZVJlZi5jdXJyZW50LnJvdGF0aW9uLnkgKz0gMC4wMTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBpZCA9IHNldEludGVydmFsKGFuaW1hdGUsIDE2KTsgLy8gfjYwZnBzXHJcblxyXG4gICAgLy8gQ29tbWVudGVkIG91dCBpbnRlcnZhbCBjbGVhbnVwXHJcbiAgICAvLyByZXR1cm4gKCkgPT4gY2xlYXJJbnRlcnZhbChpZCk7XHJcbiAgICByZXR1cm4gKCkgPT4ge307XHJcbiAgfSwgW10pO1xyXG4gICovXHJcblxyXG4gIC8vIExFR08gTE9BRElORyBDT0RFXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIC8vIE5lZWQgZWl0aGVyIG1vZGVsUGF0aCBvciBsZHJhd0NvbnRlbnRcclxuICAgIGlmICgoIW1vZGVsUGF0aCAmJiAhbGRyYXdDb250ZW50KSB8fCAhc2NlbmVSZWYuY3VycmVudCB8fCAhcmVuZGVyZXJSZWYuY3VycmVudCB8fCAhY2FtZXJhUmVmLmN1cnJlbnQpIHJldHVybjtcclxuXHJcbiAgICAvLyBTa2lwIGlmIHdlJ3JlIGFscmVhZHkgbG9hZGluZyB0aGlzIGV4YWN0IG1vZGVsXHJcbiAgICBjb25zdCBjdXJyZW50SWRlbnRpZmllciA9IGxkcmF3Q29udGVudCA/IGBjb250ZW50LSR7bGRyYXdDb250ZW50LnN1YnN0cmluZygwLCAxMDApfWAgOiBtb2RlbFBhdGg7XHJcbiAgICBpZiAoY3VycmVudE1vZGVsUGF0aFJlZi5jdXJyZW50ID09PSBjdXJyZW50SWRlbnRpZmllciAmJiBpc0xvYWRpbmdSZWYuY3VycmVudCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnU2FtZSBtb2RlbCBhbHJlYWR5IGxvYWRpbmcsIHNraXBwaW5nLi4uJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTa2lwIGlmIHRoaXMgbW9kZWwgaXMgYWxyZWFkeSBsb2FkZWRcclxuICAgIGlmIChjdXJyZW50TW9kZWxQYXRoUmVmLmN1cnJlbnQgPT09IGN1cnJlbnRJZGVudGlmaWVyICYmIG1vZGVsR3JvdXBSZWYuY3VycmVudCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnTW9kZWwgYWxyZWFkeSBsb2FkZWQsIHNraXBwaW5nLi4uJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBQcmV2ZW50IGNvbmN1cnJlbnQgbG9hZHNcclxuICAgIGlmIChpc0xvYWRpbmdSZWYuY3VycmVudCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnQW5vdGhlciBtb2RlbCBpcyBsb2FkaW5nLCBza2lwcGluZy4uLicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2xlYW4gdXAgcHJldmlvdXMgbW9kZWwgc2FmZWx5XHJcbiAgICBpZiAobW9kZWxHcm91cFJlZi5jdXJyZW50ICYmIHNjZW5lUmVmLmN1cnJlbnQpIHtcclxuICAgICAgY29uc29sZS5sb2coJ1JlbW92aW5nIHByZXZpb3VzIG1vZGVsIGZyb20gc2NlbmUnKTtcclxuICAgICAgLy8gTWFyayBhcyBpbnZpc2libGUgZmlyc3QgdG8gcHJldmVudCByZW5kZXIgaXNzdWVzXHJcbiAgICAgIG1vZGVsR3JvdXBSZWYuY3VycmVudC52aXNpYmxlID0gZmFsc2U7XHJcblxyXG4gICAgICAvLyBSZW1vdmUgZnJvbSBzY2VuZSBvbiBuZXh0IHRpY2tcclxuICAgICAgY29uc3QgbW9kZWxUb1JlbW92ZSA9IG1vZGVsR3JvdXBSZWYuY3VycmVudDtcclxuICAgICAgbW9kZWxHcm91cFJlZi5jdXJyZW50ID0gbnVsbDtcclxuXHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIGlmIChzY2VuZVJlZi5jdXJyZW50ICYmIG1vZGVsVG9SZW1vdmUpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdBY3R1YWxseSByZW1vdmluZyBtb2RlbCBhbmQgZGlzcG9zaW5nIHJlc291cmNlcycpO1xyXG4gICAgICAgICAgc2NlbmVSZWYuY3VycmVudC5yZW1vdmUobW9kZWxUb1JlbW92ZSk7XHJcbiAgICAgICAgICAvLyBEaXNwb3NlIG9mIGdlb21ldHJpZXMgYW5kIG1hdGVyaWFscyBpZiBuZWVkZWRcclxuICAgICAgICAgIG1vZGVsVG9SZW1vdmUudHJhdmVyc2UoKGNoaWxkOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGNoaWxkLmdlb21ldHJ5KSBjaGlsZC5nZW9tZXRyeS5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgIGlmIChjaGlsZC5tYXRlcmlhbCkge1xyXG4gICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNoaWxkLm1hdGVyaWFsKSkge1xyXG4gICAgICAgICAgICAgICAgY2hpbGQubWF0ZXJpYWwuZm9yRWFjaCgobWF0OiBhbnkpID0+IG1hdC5kaXNwb3NlKCkpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5tYXRlcmlhbC5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdNb2RlbCByZW1vdmFsIGNvbXBsZXRlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAwKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBQcmV2ZW50IG11bHRpcGxlIGxvYWRzIG9mIHRoZSBzYW1lIG1vZGVsXHJcbiAgICBsZXQgY2FuY2VsbGVkID0gZmFsc2U7XHJcbiAgICBpc0xvYWRpbmdSZWYuY3VycmVudCA9IHRydWU7XHJcbiAgICBjdXJyZW50TW9kZWxQYXRoUmVmLmN1cnJlbnQgPSBjdXJyZW50SWRlbnRpZmllciB8fCAnZ2VuZXJhdGVkJztcclxuXHJcbiAgICBjb25zdCBsb2FkZXIgPSBuZXcgTERyYXdMb2FkZXIobG9hZGluZ01hbmFnZXJSZWYuY3VycmVudCA/PyB1bmRlZmluZWQpO1xyXG5cclxuICAgIC8vIFNldCB0aGUgcGFydHMgbGlicmFyeSBwYXRoIHRvIHRoZSBsZHJhdyBkaXJlY3RvcnlcclxuICAgIGxvYWRlci5zZXRQYXJ0c0xpYnJhcnlQYXRoKCcvbGRyYXcvJyk7XHJcblxyXG4gICAgLy8gU2V0IHRoZSBmaWxlIG1hcCBmb3IgYmV0dGVyIHBhcnQgcmVzb2x1dGlvblxyXG4gICAgbG9hZGVyLnNldEZpbGVNYXAoe30pO1xyXG5cclxuICAgIC8vIFNldCB0aGUgY29uZGl0aW9uYWwgbGluZSBtYXRlcmlhbCBjbGFzcyAobm90IGFuIGluc3RhbmNlKVxyXG4gICAgbG9hZGVyLnNldENvbmRpdGlvbmFsTGluZU1hdGVyaWFsKExEcmF3Q29uZGl0aW9uYWxMaW5lTWF0ZXJpYWwpO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGxkcmF3Q29udGVudCA/ICdMb2FkaW5nIExEcmF3IGZyb20gY29udGVudCcgOiBgTG9hZGluZyBMRFIgZmlsZTogJHttb2RlbFBhdGh9YCk7XHJcblxyXG4gICAgLy8gVHJ5IHRvIHByZWxvYWQgbWF0ZXJpYWxzIGZpcnN0LCBidXQgZG9uJ3QgZmFpbCBpZiBpdCBkb2Vzbid0IHdvcmtcclxuICAgIGNvbnN0IG1hdGVyaWFsc1Byb21pc2UgPSBsb2FkZXIucHJlbG9hZE1hdGVyaWFscygnL2xkcmF3L0xEQ29uZmlnLmxkcicpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnTWF0ZXJpYWxzIHByZWxvYWRlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBwcmVsb2FkIG1hdGVyaWFscywgdXNpbmcgZGVmYXVsdHM6JywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyBMb2FkIHRoZSBtb2RlbCAod2FpdCBmb3IgbWF0ZXJpYWxzIGlmIHBvc3NpYmxlLCBidXQgZG9uJ3QgYmxvY2spXHJcbiAgICBQcm9taXNlLmFsbChbbWF0ZXJpYWxzUHJvbWlzZV0pXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBpZiAoY2FuY2VsbGVkKSByZXR1cm47XHJcblxyXG4gICAgICAgIC8vIElmIHdlIGhhdmUgZGlyZWN0IGNvbnRlbnQsIHBhcnNlIGl0OyBvdGhlcndpc2UgbG9hZCBmcm9tIGZpbGVcclxuICAgICAgICBpZiAobGRyYXdDb250ZW50KSB7XHJcbiAgICAgICAgICByZXR1cm4gbG9hZGVyLnBhcnNlKGxkcmF3Q29udGVudCwgJy8nKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG1vZGVsUGF0aCkge1xyXG4gICAgICAgICAgcmV0dXJuIGxvYWRlci5sb2FkQXN5bmMobW9kZWxQYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKChncm91cCkgPT4ge1xyXG4gICAgICAgIGlmICghZ3JvdXAgfHwgY2FuY2VsbGVkKSByZXR1cm47XHJcbiAgICAgICAgY29uc29sZS5sb2coJ01vZGVsIGxvYWRlZCBzdWNjZXNzZnVsbHk6JywgZ3JvdXApO1xyXG4gICAgICAgIGlzTG9hZGluZ1JlZi5jdXJyZW50ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIC8vIEZpeCBudWxsIG1hdGVyaWFscyBhbmQgY2hpbGRyZW4gaXNzdWVzXHJcbiAgICAgICAgZ3JvdXAudHJhdmVyc2UoKGNoaWxkKSA9PiB7XHJcbiAgICAgICAgICAvLyBDaGVjayBmb3IgbnVsbCBjaGlsZHJlblxyXG4gICAgICAgICAgaWYgKGNoaWxkLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsTGVuZ3RoID0gY2hpbGQuY2hpbGRyZW4ubGVuZ3RoO1xyXG4gICAgICAgICAgICBjaGlsZC5jaGlsZHJlbiA9IGNoaWxkLmNoaWxkcmVuLmZpbHRlcigoYzogYW55KSA9PiBjICE9PSBudWxsICYmIGMgIT09IHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIGlmIChjaGlsZC5jaGlsZHJlbi5sZW5ndGggIT09IG9yaWdpbmFsTGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdSZW1vdmVkIG51bGwgY2hpbGRyZW4gZnJvbTonLCBjaGlsZC5uYW1lIHx8IGNoaWxkLnV1aWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gRml4IG51bGwgbWF0ZXJpYWxzXHJcbiAgICAgICAgICBpZiAoKGNoaWxkIGFzIGFueSkuaXNNZXNoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1lc2ggPSBjaGlsZCBhcyBUSFJFRS5NZXNoO1xyXG4gICAgICAgICAgICBpZiAoIW1lc2gubWF0ZXJpYWwpIHtcclxuICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBkZWZhdWx0IG1hdGVyaWFsIGlmIG1pc3NpbmdcclxuICAgICAgICAgICAgICBtZXNoLm1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHtcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAweDgwODA4MCxcclxuICAgICAgICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGVcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQWRkZWQgZGVmYXVsdCBtYXRlcmlhbCB0byBtZXNoOicsIG1lc2gubmFtZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShtZXNoLm1hdGVyaWFsKSkge1xyXG4gICAgICAgICAgICAgIC8vIENoZWNrIGFycmF5IG9mIG1hdGVyaWFsc1xyXG4gICAgICAgICAgICAgIG1lc2gubWF0ZXJpYWwgPSBtZXNoLm1hdGVyaWFsLm1hcCgobWF0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW1hdCkge1xyXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUmVwbGFjaW5nIG51bGwgbWF0ZXJpYWwgaW4gYXJyYXknKTtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IDB4ODA4MDgwLFxyXG4gICAgICAgICAgICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGVcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0O1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFBvc2l0aW9uIG1vZGVsIGF0IG9yaWdpbiBhbmQgcm90YXRlIDE4MCBkZWdyZWVzXHJcbiAgICAgICAgZ3JvdXAucG9zaXRpb24uc2V0KDAsIDAsIDApO1xyXG4gICAgICAgIC8vIGdyb3VwLnJvdGF0aW9uLnggPSBNYXRoLlBJOyAvLyBSb3RhdGUgMTgwIGRlZ3JlZXMgYXJvdW5kIFggYXhpc1xyXG4gICAgICAgIG1vZGVsR3JvdXBSZWYuY3VycmVudCA9IGdyb3VwO1xyXG5cclxuICAgICAgICBpZiAoc2NlbmVSZWYuY3VycmVudCkge1xyXG4gICAgICAgICAgc2NlbmVSZWYuY3VycmVudC5hZGQoZ3JvdXApO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ01vZGVsIGFkZGVkIHRvIHNjZW5lJyk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnR3JvdXAgY2hpbGRyZW46JywgZ3JvdXAuY2hpbGRyZW4ubGVuZ3RoKTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdHcm91cCB2aXNpYmxlOicsIGdyb3VwLnZpc2libGUpO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ0dyb3VwIGluIHNjZW5lOicsIHNjZW5lUmVmLmN1cnJlbnQuY2hpbGRyZW4uaW5jbHVkZXMoZ3JvdXApKTtcclxuXHJcbiAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIGdyb3VwIGlzIHZpc2libGVcclxuICAgICAgICAgIGdyb3VwLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgICAgZ3JvdXAudHJhdmVyc2UoKGNoaWxkKSA9PiB7XHJcbiAgICAgICAgICAgIGNoaWxkLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgLy8gQ291bnQgdmlzaWJsZSBtZXNoZXMgYW5kIGNoZWNrIG1hdGVyaWFsc1xyXG4gICAgICAgICAgbGV0IG1lc2hDb3VudCA9IDA7XHJcbiAgICAgICAgICBsZXQgdmlzaWJsZUNvdW50ID0gMDtcclxuICAgICAgICAgIGdyb3VwLnRyYXZlcnNlKChjaGlsZCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoKGNoaWxkIGFzIGFueSkuaXNNZXNoKSB7XHJcbiAgICAgICAgICAgICAgbWVzaENvdW50Kys7XHJcbiAgICAgICAgICAgICAgY29uc3QgbWVzaCA9IGNoaWxkIGFzIFRIUkVFLk1lc2g7XHJcbiAgICAgICAgICAgICAgaWYgKG1lc2gudmlzaWJsZSkgdmlzaWJsZUNvdW50Kys7XHJcblxyXG4gICAgICAgICAgICAgIGlmICghbWVzaC5nZW9tZXRyeS5ib3VuZGluZ0JveCkge1xyXG4gICAgICAgICAgICAgICAgbWVzaC5nZW9tZXRyeS5jb21wdXRlQm91bmRpbmdCb3goKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIExvZyBtZXNoIGRldGFpbHNcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTWVzaCBkZXRhaWxzOicsIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG1lc2gubmFtZSxcclxuICAgICAgICAgICAgICAgIHZpc2libGU6IG1lc2gudmlzaWJsZSxcclxuICAgICAgICAgICAgICAgIG1hdGVyaWFsOiBtZXNoLm1hdGVyaWFsLFxyXG4gICAgICAgICAgICAgICAgZ2VvbWV0cnlWZXJ0aWNlczogbWVzaC5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uPy5jb3VudCB8fCAwLFxyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IG1lc2gucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICBzY2FsZTogbWVzaC5zY2FsZVxyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgbWVzaCBoYXMgYSBtYXRlcmlhbFxyXG4gICAgICAgICAgICAgIGlmICghbWVzaC5tYXRlcmlhbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdNZXNoIGhhcyBubyBtYXRlcmlhbCwgYWRkaW5nIGRlZmF1bHQnKTtcclxuICAgICAgICAgICAgICAgIG1lc2gubWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgICAgICAgICBjb2xvcjogMHhmZjAwMDAsXHJcbiAgICAgICAgICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhgRm91bmQgJHttZXNoQ291bnR9IG1lc2hlcywgJHt2aXNpYmxlQ291bnR9IHZpc2libGVgKTtcclxuXHJcbiAgICAgICAgICAvLyBUZXN0IGN1YmUgcmVtb3ZlZCAtIHJlbmRlcmluZyB2ZXJpZmllZCB0byBiZSB3b3JraW5nXHJcbiAgICAgICAgICAvLyBjb25zdCB0ZXN0R2VvbWV0cnkgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoNTAsIDUwLCA1MCk7XHJcbiAgICAgICAgICAvLyBjb25zdCB0ZXN0TWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoeyBjb2xvcjogMHgwMGZmMDAgfSk7XHJcbiAgICAgICAgICAvLyBjb25zdCB0ZXN0Q3ViZSA9IG5ldyBUSFJFRS5NZXNoKHRlc3RHZW9tZXRyeSwgdGVzdE1hdGVyaWFsKTtcclxuICAgICAgICAgIC8vIHRlc3RDdWJlLnBvc2l0aW9uLnNldCgxMDAsIDI1LCAwKTtcclxuICAgICAgICAgIC8vIHNjZW5lUmVmLmN1cnJlbnQuYWRkKHRlc3RDdWJlKTtcclxuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdUZXN0IGN1YmUgYWRkZWQgYXQ6JywgdGVzdEN1YmUucG9zaXRpb24pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRm9yY2UgdXBkYXRlIG1hdHJpY2VzIGJlZm9yZSBjYWxjdWxhdGluZyBib3VuZGluZyBib3hcclxuICAgICAgICBncm91cC51cGRhdGVNYXRyaXhXb3JsZCh0cnVlKTtcclxuXHJcbiAgICAgICAgLy8gQ2FsY3VsYXRlIGJvdW5kaW5nIGJveCBhbmQgY2VudGVyIGNhbWVyYVxyXG4gICAgICAgIGNvbnN0IGJveCA9IG5ldyBUSFJFRS5Cb3gzKCkuc2V0RnJvbU9iamVjdChncm91cCk7XHJcbiAgICAgICAgY29uc3QgY2VudGVyID0gYm94LmdldENlbnRlcihuZXcgVEhSRUUuVmVjdG9yMygpKTtcclxuICAgICAgICBjb25zdCBzaXplID0gYm94LmdldFNpemUobmV3IFRIUkVFLlZlY3RvcjMoKSk7XHJcblxyXG4gICAgICAgIC8vIExvZyBtb2RlbCBpbmZvcm1hdGlvblxyXG4gICAgICAgIGlmICghYm94LmlzRW1wdHkoKSAmJiBzaXplLnggPiAwICYmIHNpemUueSA+IDAgJiYgc2l6ZS56ID4gMCkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ01vZGVsIGNlbnRlcjonLCBjZW50ZXIueCwgY2VudGVyLnksIGNlbnRlci56KTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdNb2RlbCBzaXplOicsIHNpemUueCwgc2l6ZS55LCBzaXplLnopO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ01vZGVsIGhhcyBlbXB0eS9pbnZhbGlkIGJvdW5kaW5nIGJveCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNvbnRyb2xzUmVmLmN1cnJlbnQpIHtcclxuICAgICAgICAgIC8vIEp1c3QgdXBkYXRlIGNvbnRyb2xzIHRvIGxvb2sgYXQgb3JpZ2luXHJcbiAgICAgICAgICBjb250cm9sc1JlZi5jdXJyZW50LnRhcmdldC5zZXQoMCwgMCwgMCk7XHJcbiAgICAgICAgICBjb250cm9sc1JlZi5jdXJyZW50LnVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVGhlIGFuaW1hdGlvbiBsb29wIHdpbGwgaGFuZGxlIHJlbmRlcmluZ1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdTY2VuZSBjaGlsZHJlbjonLCBzY2VuZVJlZi5jdXJyZW50Py5jaGlsZHJlbi5sZW5ndGggfHwgMCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICBpZiAoY2FuY2VsbGVkKSByZXR1cm47XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9hZGluZyBtb2RlbDonLCBlcnJvcik7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignTW9kZWwgcGF0aDonLCBtb2RlbFBhdGgpO1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1N0YWNrIHRyYWNlOicsIGVycm9yLnN0YWNrKTtcclxuICAgICAgICBpc0xvYWRpbmdSZWYuY3VycmVudCA9IGZhbHNlO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyBDbGVhbnVwIGZ1bmN0aW9uIC0gb25seSByZW1vdmUgbW9kZWwgaWYgcGF0aCBjaGFuZ2VzIG9yIGNvbXBvbmVudCB1bm1vdW50c1xyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgY2FuY2VsbGVkID0gdHJ1ZTtcclxuICAgICAgLy8gRG9uJ3QgY2xlYXIgdGhlIG1vZGVsIGhlcmUgLSBpdCB3aWxsIGJlIGNsZWFyZWQgd2hlbiBhIG5ldyBtb2RlbCBsb2Fkc1xyXG4gICAgICAvLyBvciB3aGVuIHRoZSBjb21wb25lbnQgdW5tb3VudHNcclxuICAgIH07XHJcbiAgfSwgW21vZGVsUGF0aCwgbGRyYXdDb250ZW50XSk7XHJcblxyXG4gIC8vIENsZWFuIHVwIG1vZGVsIHdoZW4gY29tcG9uZW50IHVubW91bnRzXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgIGlmIChtb2RlbEdyb3VwUmVmLmN1cnJlbnQgJiYgc2NlbmVSZWYuY3VycmVudCkge1xyXG4gICAgICAgIC8vIE1hcmsgYXMgaW52aXNpYmxlIGZpcnN0XHJcbiAgICAgICAgbW9kZWxHcm91cFJlZi5jdXJyZW50LnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAvLyBUaGVuIHJlbW92ZVxyXG4gICAgICAgIHNjZW5lUmVmLmN1cnJlbnQucmVtb3ZlKG1vZGVsR3JvdXBSZWYuY3VycmVudCk7XHJcbiAgICAgICAgbW9kZWxHcm91cFJlZi5jdXJyZW50ID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICBpc0xvYWRpbmdSZWYuY3VycmVudCA9IGZhbHNlO1xyXG4gICAgICBjdXJyZW50TW9kZWxQYXRoUmVmLmN1cnJlbnQgPSAnJztcclxuICAgIH07XHJcbiAgfSwgW10pO1xyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPGRpdlxyXG4gICAgICByZWY9e2NvbnRhaW5lclJlZn1cclxuICAgICAgc3R5bGU9e3tcclxuICAgICAgICB3aWR0aDogJzEwMCUnLFxyXG4gICAgICAgIGhlaWdodDogJzYwMHB4JyxcclxuICAgICAgICBib3JkZXI6ICcxcHggc29saWQgI2NjYycsXHJcbiAgICAgICAgYm9yZGVyUmFkaXVzOiAnOHB4JyxcclxuICAgICAgICBvdmVyZmxvdzogJ2hpZGRlbidcclxuICAgICAgfX1cclxuICAgIC8+XHJcbiAgKTtcclxufTtcclxuXHJcbmNvbnN0IExEUlZpZXdlciA9IG1lbW8oTERSVmlld2VyQ29tcG9uZW50KTtcclxuZXhwb3J0IGRlZmF1bHQgTERSVmlld2VyO1xyXG4iXSwibmFtZXMiOlsiUmVhY3QiLCJ1c2VFZmZlY3QiLCJ1c2VSZWYiLCJtZW1vIiwiVEhSRUUiLCJPcmJpdENvbnRyb2xzIiwiTERyYXdMb2FkZXIiLCJMRHJhd0NvbmRpdGlvbmFsTGluZU1hdGVyaWFsIiwiTERSVmlld2VyQ29tcG9uZW50IiwibW9kZWxQYXRoIiwibGRyYXdDb250ZW50IiwiY29udGFpbmVyUmVmIiwic2NlbmVSZWYiLCJyZW5kZXJlclJlZiIsImNhbWVyYVJlZiIsImNvbnRyb2xzUmVmIiwibW9kZWxHcm91cFJlZiIsImxvYWRpbmdNYW5hZ2VyUmVmIiwiaXNMb2FkaW5nUmVmIiwiY3VycmVudE1vZGVsUGF0aFJlZiIsImlzSW5pdGlhbGl6ZWRSZWYiLCJlcnJvckNvdW50UmVmIiwiY3VycmVudCIsIm1hbmFnZXIiLCJMb2FkaW5nTWFuYWdlciIsInNldFVSTE1vZGlmaWVyIiwidXJsIiwibm9ybWFsaXplZCIsInJlcGxhY2UiLCJpbmNsdWRlcyIsIm1hdGNoIiwicGFydHMiLCJzcGxpdCIsImxhc3RUd28iLCJzbGljZSIsInVybFBhcnRzIiwiZmlsZW5hbWUiLCJsZW5ndGgiLCJ0b0xvd2VyQ2FzZSIsImhhc1N1YmRpciIsInBhdGhQcmVmaXhlcyIsInByZWZpeCIsInN0YXJ0c1dpdGgiLCJlbmRzV2l0aCIsInVuZGVmaW5lZCIsImNvbnRhaW5lciIsIndpZHRoIiwiY2xpZW50V2lkdGgiLCJoZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJzY2VuZSIsIlNjZW5lIiwiYmFja2dyb3VuZCIsIkNvbG9yIiwiY2FtZXJhIiwiUGVyc3BlY3RpdmVDYW1lcmEiLCJwb3NpdGlvbiIsInNldCIsInJlbmRlcmVyIiwiV2ViR0xSZW5kZXJlciIsImFudGlhbGlhcyIsInNldFNpemUiLCJzZXRQaXhlbFJhdGlvIiwid2luZG93IiwiZGV2aWNlUGl4ZWxSYXRpbyIsImFwcGVuZENoaWxkIiwiZG9tRWxlbWVudCIsImNvbnRyb2xzIiwiZW5hYmxlRGFtcGluZyIsImRhbXBpbmdGYWN0b3IiLCJlbmFibGVQYW4iLCJlbmFibGVSb3RhdGUiLCJlbmFibGVab29tIiwic2NyZWVuU3BhY2VQYW5uaW5nIiwibWluRGlzdGFuY2UiLCJtYXhEaXN0YW5jZSIsInRhcmdldCIsImFkZCIsIkFtYmllbnRMaWdodCIsImRpckxpZ2h0IiwiRGlyZWN0aW9uYWxMaWdodCIsImNhc3RTaGFkb3ciLCJmaWxsTGlnaHQxIiwiZmlsbExpZ2h0MiIsImhlbWlMaWdodCIsIkhlbWlzcGhlcmVMaWdodCIsImF4ZXNIZWxwZXIiLCJBeGVzSGVscGVyIiwiaGFuZGxlUmVzaXplIiwidyIsImgiLCJhc3BlY3QiLCJ1cGRhdGVQcm9qZWN0aW9uTWF0cml4IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbnNvbGUiLCJsb2ciLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYW5pbWF0aW9uSWRSZWYiLCJpc0FuaW1hdGluZ1JlZiIsImFuaW1hdGUiLCJ3YXJuIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiaGFzTnVsbENoaWxkcmVuIiwibnVsbENoZWNrQ291bnQiLCJ0cmF2ZXJzZSIsImNoaWxkIiwiaGFzT3duUHJvcGVydHkiLCJlcnJvciIsImNoaWxkcmVuIiwiaSIsInNwbGljZSIsImlzRmluaXRlIiwieCIsInkiLCJ6IiwidXBkYXRlIiwicmVuZGVyIiwidmlzaWJsZSIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwiY3VycmVudElkZW50aWZpZXIiLCJzdWJzdHJpbmciLCJtb2RlbFRvUmVtb3ZlIiwic2V0VGltZW91dCIsInJlbW92ZSIsImdlb21ldHJ5IiwiZGlzcG9zZSIsIm1hdGVyaWFsIiwiQXJyYXkiLCJpc0FycmF5IiwiZm9yRWFjaCIsIm1hdCIsImNhbmNlbGxlZCIsImxvYWRlciIsInNldFBhcnRzTGlicmFyeVBhdGgiLCJzZXRGaWxlTWFwIiwic2V0Q29uZGl0aW9uYWxMaW5lTWF0ZXJpYWwiLCJtYXRlcmlhbHNQcm9taXNlIiwicHJlbG9hZE1hdGVyaWFscyIsInRoZW4iLCJjYXRjaCIsImVyciIsIm1lc3NhZ2UiLCJQcm9taXNlIiwiYWxsIiwicGFyc2UiLCJsb2FkQXN5bmMiLCJncm91cCIsIm9yaWdpbmFsTGVuZ3RoIiwiZmlsdGVyIiwiYyIsIm5hbWUiLCJ1dWlkIiwiaXNNZXNoIiwibWVzaCIsIk1lc2hQaG9uZ01hdGVyaWFsIiwiY29sb3IiLCJzaWRlIiwiRG91YmxlU2lkZSIsIm1hcCIsIm1lc2hDb3VudCIsInZpc2libGVDb3VudCIsImJvdW5kaW5nQm94IiwiY29tcHV0ZUJvdW5kaW5nQm94IiwiZ2VvbWV0cnlWZXJ0aWNlcyIsImF0dHJpYnV0ZXMiLCJjb3VudCIsInNjYWxlIiwidXBkYXRlTWF0cml4V29ybGQiLCJib3giLCJCb3gzIiwic2V0RnJvbU9iamVjdCIsImNlbnRlciIsImdldENlbnRlciIsIlZlY3RvcjMiLCJzaXplIiwiZ2V0U2l6ZSIsImlzRW1wdHkiLCJzdGFjayIsImRpdiIsInJlZiIsInN0eWxlIiwiYm9yZGVyIiwiYm9yZGVyUmFkaXVzIiwib3ZlcmZsb3ciLCJMRFJWaWV3ZXIiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/LDRViewer.tsx\n");

/***/ })

};
;